<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Using GeoJSON in Leaflet | Leaflet book</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Using GeoJSON in Leaflet | Leaflet book" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Using GeoJSON in Leaflet | Leaflet book" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Samuel Gachuhi Ngugi" />


<meta name="date" content="2023-06-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="embedding-leaflet-map-to-an-external-website.html"/>
<link rel="next" href="create-your-own-custom-markers.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i>Usage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i>Render book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i>Preview book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-leaflet"><i class="fa fa-check"></i><b>1.1</b> What is Leaflet?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#how-does-it-work"><i class="fa fa-check"></i><b>1.2</b> How does it work?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#javascript"><i class="fa fa-check"></i><b>1.3</b> JavaScript</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#css-files"><i class="fa fa-check"></i><b>1.4</b> CSS files</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#summary"><i class="fa fa-check"></i><b>1.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="first-leaflet-map.html"><a href="first-leaflet-map.html"><i class="fa fa-check"></i><b>2</b> First Leaflet Map</a>
<ul>
<li class="chapter" data-level="2.1" data-path="first-leaflet-map.html"><a href="first-leaflet-map.html#setting-the-superstructure"><i class="fa fa-check"></i><b>2.1</b> Setting the superstructure</a></li>
<li class="chapter" data-level="2.2" data-path="first-leaflet-map.html"><a href="first-leaflet-map.html#beautifying-the-house"><i class="fa fa-check"></i><b>2.2</b> Beautifying the house</a></li>
<li class="chapter" data-level="2.3" data-path="first-leaflet-map.html"><a href="first-leaflet-map.html#summary-1"><i class="fa fa-check"></i><b>2.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="add-ons.html"><a href="add-ons.html"><i class="fa fa-check"></i><b>3</b> Add ons</a>
<ul>
<li class="chapter" data-level="3.1" data-path="add-ons.html"><a href="add-ons.html#a-marker"><i class="fa fa-check"></i><b>3.1</b> A marker</a></li>
<li class="chapter" data-level="3.2" data-path="add-ons.html"><a href="add-ons.html#a-marker-with-a-popup"><i class="fa fa-check"></i><b>3.2</b> A marker with a popup</a></li>
<li class="chapter" data-level="3.3" data-path="add-ons.html"><a href="add-ons.html#different-markers-and-popups"><i class="fa fa-check"></i><b>3.3</b> Different markers and popups</a></li>
<li class="chapter" data-level="3.4" data-path="add-ons.html"><a href="add-ons.html#summary-2"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="embedding-leaflet-map-to-an-external-website.html"><a href="embedding-leaflet-map-to-an-external-website.html"><i class="fa fa-check"></i><b>4</b> Embedding leaflet map to an external website</a>
<ul>
<li class="chapter" data-level="4.1" data-path="embedding-leaflet-map-to-an-external-website.html"><a href="embedding-leaflet-map-to-an-external-website.html#the-html-webpage"><i class="fa fa-check"></i><b>4.1</b> The html webpage</a></li>
<li class="chapter" data-level="4.2" data-path="embedding-leaflet-map-to-an-external-website.html"><a href="embedding-leaflet-map-to-an-external-website.html#the-css"><i class="fa fa-check"></i><b>4.2</b> The CSS</a></li>
<li class="chapter" data-level="4.3" data-path="embedding-leaflet-map-to-an-external-website.html"><a href="embedding-leaflet-map-to-an-external-website.html#the-leaflet-javascript-code-for-our-website"><i class="fa fa-check"></i><b>4.3</b> The leaflet JavaScript code for our website</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html"><i class="fa fa-check"></i><b>5</b> Using GeoJSON in Leaflet</a>
<ul>
<li class="chapter" data-level="5.1" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#creating-a-.geojson-file"><i class="fa fa-check"></i><b>5.1</b> Creating a <code>.geojson</code> file</a></li>
<li class="chapter" data-level="5.2" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#what-are-.geojson-files"><i class="fa fa-check"></i><b>5.2</b> What are <code>.geojson</code> files?</a></li>
<li class="chapter" data-level="5.3" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#why-geojson"><i class="fa fa-check"></i><b>5.3</b> Why <code>geojson</code>?</a></li>
<li class="chapter" data-level="5.4" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#creating-a-geojson-file"><i class="fa fa-check"></i><b>5.4</b> Creating a geojson file</a></li>
<li class="chapter" data-level="5.5" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#saving-the-geojson-to-github"><i class="fa fa-check"></i><b>5.5</b> Saving the Geojson to Github</a></li>
<li class="chapter" data-level="5.6" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#loading-the-geojson-into-leaflet"><i class="fa fa-check"></i><b>5.6</b> Loading the GeoJSON into Leaflet</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#the-easy-way"><i class="fa fa-check"></i><b>5.6.1</b> The easy way</a></li>
<li class="chapter" data-level="5.6.2" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#using-the-ajax-plugin"><i class="fa fa-check"></i><b>5.6.2</b> Using the Ajax Plugin</a></li>
<li class="chapter" data-level="5.6.3" data-path="using-geojson-in-leaflet.html"><a href="using-geojson-in-leaflet.html#using-fetch-api"><i class="fa fa-check"></i><b>5.6.3</b> Using Fetch API</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="create-your-own-custom-markers.html"><a href="create-your-own-custom-markers.html"><i class="fa fa-check"></i><b>6</b> Create your own custom markers</a>
<ul>
<li class="chapter" data-level="6.1" data-path="create-your-own-custom-markers.html"><a href="create-your-own-custom-markers.html#the-icons"><i class="fa fa-check"></i><b>6.1</b> The icons</a></li>
<li class="chapter" data-level="6.2" data-path="create-your-own-custom-markers.html"><a href="create-your-own-custom-markers.html#differentiate-custom-markers-on-a-webmap"><i class="fa fa-check"></i><b>6.2</b> Differentiate custom markers on a webmap</a></li>
<li class="chapter" data-level="6.3" data-path="create-your-own-custom-markers.html"><a href="create-your-own-custom-markers.html#using-fetch"><i class="fa fa-check"></i><b>6.3</b> Using fetch</a></li>
<li class="chapter" data-level="6.4" data-path="create-your-own-custom-markers.html"><a href="create-your-own-custom-markers.html#unique-custom-markers"><i class="fa fa-check"></i><b>6.4</b> Unique custom markers</a></li>
<li class="chapter" data-level="6.5" data-path="create-your-own-custom-markers.html"><a href="create-your-own-custom-markers.html#image-overlays"><i class="fa fa-check"></i><b>6.5</b> Image overlays</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="creating-an-interactive-choropleth-map.html"><a href="creating-an-interactive-choropleth-map.html"><i class="fa fa-check"></i><b>7</b> Creating an interactive choropleth map</a>
<ul>
<li class="chapter" data-level="7.1" data-path="creating-an-interactive-choropleth-map.html"><a href="creating-an-interactive-choropleth-map.html#what-is-a-choropleth-map"><i class="fa fa-check"></i><b>7.1</b> What is a choropleth map?</a></li>
<li class="chapter" data-level="7.2" data-path="creating-an-interactive-choropleth-map.html"><a href="creating-an-interactive-choropleth-map.html#creating-a-choropleth-map-the-start"><i class="fa fa-check"></i><b>7.2</b> Creating a choropleth map: the start</a></li>
<li class="chapter" data-level="7.3" data-path="creating-an-interactive-choropleth-map.html"><a href="creating-an-interactive-choropleth-map.html#coloring-the-counties"><i class="fa fa-check"></i><b>7.3</b> Coloring the counties</a></li>
<li class="chapter" data-level="7.4" data-path="creating-an-interactive-choropleth-map.html"><a href="creating-an-interactive-choropleth-map.html#highlight-features"><i class="fa fa-check"></i><b>7.4</b> Highlight features</a></li>
<li class="chapter" data-level="7.5" data-path="creating-an-interactive-choropleth-map.html"><a href="creating-an-interactive-choropleth-map.html#creating-a-custom-info"><i class="fa fa-check"></i><b>7.5</b> Creating a custom info</a></li>
<li class="chapter" data-level="7.6" data-path="creating-an-interactive-choropleth-map.html"><a href="creating-an-interactive-choropleth-map.html#create-a-legend"><i class="fa fa-check"></i><b>7.6</b> Create a legend</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="layer-groups-and-controls.html"><a href="layer-groups-and-controls.html"><i class="fa fa-check"></i><b>8</b> Layer groups and controls</a>
<ul>
<li class="chapter" data-level="8.1" data-path="layer-groups-and-controls.html"><a href="layer-groups-and-controls.html#purpose-of-layer-groups-and-controls"><i class="fa fa-check"></i><b>8.1</b> Purpose of layer groups and controls</a></li>
<li class="chapter" data-level="8.2" data-path="layer-groups-and-controls.html"><a href="layer-groups-and-controls.html#set-up-the-basemaps"><i class="fa fa-check"></i><b>8.2</b> Set up the basemaps</a></li>
<li class="chapter" data-level="8.3" data-path="layer-groups-and-controls.html"><a href="layer-groups-and-controls.html#creating-the-controls"><i class="fa fa-check"></i><b>8.3</b> Creating the controls</a></li>
<li class="chapter" data-level="8.4" data-path="layer-groups-and-controls.html"><a href="layer-groups-and-controls.html#adding-overlay-maps"><i class="fa fa-check"></i><b>8.4</b> Adding overlay maps</a></li>
<li class="chapter" data-level="8.5" data-path="layer-groups-and-controls.html"><a href="layer-groups-and-controls.html#add-a-scale-bar"><i class="fa fa-check"></i><b>8.5</b> Add a scale bar</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="heatmaps.html"><a href="heatmaps.html"><i class="fa fa-check"></i><b>9</b> Heatmaps</a>
<ul>
<li class="chapter" data-level="9.1" data-path="heatmaps.html"><a href="heatmaps.html#what-are-heatmaps"><i class="fa fa-check"></i><b>9.1</b> What are heatmaps?</a></li>
<li class="chapter" data-level="9.2" data-path="heatmaps.html"><a href="heatmaps.html#loading-the-heatmap-plugin"><i class="fa fa-check"></i><b>9.2</b> Loading the heatmap plugin</a></li>
<li class="chapter" data-level="9.3" data-path="heatmaps.html"><a href="heatmaps.html#creating-the-leaflet-heatmap"><i class="fa fa-check"></i><b>9.3</b> Creating the Leaflet heatmap</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cluster-to-reduce-the-clutter.html"><a href="cluster-to-reduce-the-clutter.html"><i class="fa fa-check"></i><b>10</b> Cluster to reduce the clutter</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cluster-to-reduce-the-clutter.html"><a href="cluster-to-reduce-the-clutter.html#a-map-full-of-clutter"><i class="fa fa-check"></i><b>10.1</b> A map full of clutter</a></li>
<li class="chapter" data-level="10.2" data-path="cluster-to-reduce-the-clutter.html"><a href="cluster-to-reduce-the-clutter.html#preparations"><i class="fa fa-check"></i><b>10.2</b> Preparations</a></li>
<li class="chapter" data-level="10.3" data-path="cluster-to-reduce-the-clutter.html"><a href="cluster-to-reduce-the-clutter.html#behold-a-cluster-marker-map"><i class="fa fa-check"></i><b>10.3</b> Behold, a cluster marker map!</a></li>
<li class="chapter" data-level="10.4" data-path="cluster-to-reduce-the-clutter.html"><a href="cluster-to-reduce-the-clutter.html#additional-features-of-cluster-marker-plugin"><i class="fa fa-check"></i><b>10.4</b> Additional features of Cluster marker plugin</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="mobile-friendly-webapps.html"><a href="mobile-friendly-webapps.html"><i class="fa fa-check"></i><b>11</b> Mobile Friendly Webapps</a>
<ul>
<li class="chapter" data-level="11.1" data-path="mobile-friendly-webapps.html"><a href="mobile-friendly-webapps.html#the-basemaps"><i class="fa fa-check"></i><b>11.1</b> The basemaps</a></li>
<li class="chapter" data-level="11.2" data-path="mobile-friendly-webapps.html"><a href="mobile-friendly-webapps.html#adding-the-features"><i class="fa fa-check"></i><b>11.2</b> Adding the features</a></li>
<li class="chapter" data-level="11.3" data-path="mobile-friendly-webapps.html"><a href="mobile-friendly-webapps.html#zooming-to-mobile-users-location"><i class="fa fa-check"></i><b>11.3</b> Zooming to mobile user’s location</a></li>
<li class="chapter" data-level="11.4" data-path="mobile-friendly-webapps.html"><a href="mobile-friendly-webapps.html#add-marker-to-mobile-users-geolocation"><i class="fa fa-check"></i><b>11.4</b> Add marker to mobile user’s geolocation</a></li>
<li class="chapter" data-level="11.5" data-path="mobile-friendly-webapps.html"><a href="mobile-friendly-webapps.html#the-mobile-webmap-app-in-action"><i class="fa fa-check"></i><b>11.5</b> The mobile webmap app in action!</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="web-map-service-layers.html"><a href="web-map-service-layers.html"><i class="fa fa-check"></i><b>12</b> Web Map Service Layers</a>
<ul>
<li class="chapter" data-level="12.1" data-path="web-map-service-layers.html"><a href="web-map-service-layers.html#what-are-web-map-service-wms-layers"><i class="fa fa-check"></i><b>12.1</b> What are Web Map Service (WMS) Layers?</a></li>
<li class="chapter" data-level="12.2" data-path="web-map-service-layers.html"><a href="web-map-service-layers.html#loading-a-wms-server"><i class="fa fa-check"></i><b>12.2</b> Loading a WMS server</a></li>
<li class="chapter" data-level="12.3" data-path="web-map-service-layers.html"><a href="web-map-service-layers.html#adding-wms-to-layer-control"><i class="fa fa-check"></i><b>12.3</b> Adding WMS to layer control</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="standard-website-with-leaflet-project.html"><a href="standard-website-with-leaflet-project.html"><i class="fa fa-check"></i><b>13</b> Standard Website with Leaflet Project</a>
<ul>
<li class="chapter" data-level="13.1" data-path="standard-website-with-leaflet-project.html"><a href="standard-website-with-leaflet-project.html#get-the-html-template"><i class="fa fa-check"></i><b>13.1</b> Get the HTML Template</a></li>
<li class="chapter" data-level="13.2" data-path="standard-website-with-leaflet-project.html"><a href="standard-website-with-leaflet-project.html#insert-leaflet-to-standard-html-website"><i class="fa fa-check"></i><b>13.2</b> Insert Leaflet to standard html website</a></li>
<li class="chapter" data-level="13.3" data-path="standard-website-with-leaflet-project.html"><a href="standard-website-with-leaflet-project.html#editing-the-css"><i class="fa fa-check"></i><b>13.3</b> Editing the CSS</a></li>
<li class="chapter" data-level="13.4" data-path="standard-website-with-leaflet-project.html"><a href="standard-website-with-leaflet-project.html#adding-leaflet-to-every-webpage"><i class="fa fa-check"></i><b>13.4</b> Adding leaflet to every webpage</a></li>
<li class="chapter" data-level="13.5" data-path="standard-website-with-leaflet-project.html"><a href="standard-website-with-leaflet-project.html#posting-the-html-website-to-the-world"><i class="fa fa-check"></i><b>13.5</b> Posting the Html website to the world</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="leaflet-in-esri.html"><a href="leaflet-in-esri.html"><i class="fa fa-check"></i><b>14</b> Leaflet in ESRI</a>
<ul>
<li class="chapter" data-level="14.1" data-path="leaflet-in-esri.html"><a href="leaflet-in-esri.html#esri-leaflet-plugins"><i class="fa fa-check"></i><b>14.1</b> ESRI Leaflet plugins</a></li>
<li class="chapter" data-level="14.2" data-path="leaflet-in-esri.html"><a href="leaflet-in-esri.html#creating-an-esri-leaflet-map"><i class="fa fa-check"></i><b>14.2</b> Creating an ESRI Leaflet map</a></li>
<li class="chapter" data-level="14.3" data-path="leaflet-in-esri.html"><a href="leaflet-in-esri.html#geocode-search"><i class="fa fa-check"></i><b>14.3</b> Geocode search</a></li>
<li class="chapter" data-level="14.4" data-path="leaflet-in-esri.html"><a href="leaflet-in-esri.html#add-search-bar"><i class="fa fa-check"></i><b>14.4</b> Add search bar</a></li>
<li class="chapter" data-level="14.5" data-path="leaflet-in-esri.html"><a href="leaflet-in-esri.html#make-the-search-bar-functional"><i class="fa fa-check"></i><b>14.5</b> Make the search bar functional</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>15</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Leaflet book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-geojson-in-leaflet" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Using GeoJSON in Leaflet<a href="using-geojson-in-leaflet.html#using-geojson-in-leaflet" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="creating-a-.geojson-file" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Creating a <code>.geojson</code> file<a href="using-geojson-in-leaflet.html#creating-a-.geojson-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have created a leaflet map, added some aesthetics such as markers, and even embedded a map into a dummy website. Alright, the website wasn’t even close to good, but the methodology should be the same when working with other fully functional and better looking websites. That may be enough to give you confidence to start as a webmapper, but not so fast! There is always, and will be some more things to learn and in this case I would like to introduce another format of storing geospatial information. The use of <code>.geojson</code> files.</p>
</div>
<div id="what-are-.geojson-files" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> What are <code>.geojson</code> files?<a href="using-geojson-in-leaflet.html#what-are-.geojson-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>.geojson</code> files, according to the GIS leader ESRI, are an <a href="https://doc.arcgis.com/en/arcgis-online/reference/geojson.htm">open standard geospatial data interchange format</a> that represents simple geographic features and their nonspatial attributes. GeoJSON is based on the JavaScript Object Notation (JSON) file format which is a lightweight data exchange format that is easily interpretable by both man and machine. In very few instances can any format please both sides of the divide but JSON does, and this <a href="https://www.oracle.com/ke/database/what-is-json/">site</a> provides examples. Anyway, just like you can tell from the name, it is also based from the JavaScript programming language. If you have worked with JavaScript before, it looks very much like a data format based on dictionaries. In essence, JSON is a large dictionary holding other <em>dictionaries</em> of data within it. A GeoJSON is a JSON file that follows a certain structure and has spatial index and geometry specifications in it. See this <a href="https://datascience.aero/geospatial-data-representation-the-geojson-format/">website</a> for a geojson example.</p>
<p>An example of a GeoJSON file format structure is shown below:</p>
<pre><code>{
  &quot;type&quot;: &quot;FeatureCollection&quot;,
  &quot;features&quot;: [
    {
      &quot;type&quot;: &quot;Feature&quot;,
      &quot;properties&quot;: {
        &quot;City&quot;: &quot;Nairobi&quot;,
        &quot;Population&quot;: &quot;4, 300, 000&quot;
      },
      &quot;geometry&quot;: {
        &quot;coordinates&quot;: [
          36.80617598261199,
          -1.2868825246637812
        ],
        &quot;type&quot;: &quot;Point&quot;
      }
    },
    {
      &quot;type&quot;: &quot;Feature&quot;,
      &quot;properties&quot;: {
        &quot;City&quot;: &quot;Kisumu&quot;,
        &quot;Population&quot;: &quot;610, 082&quot;
      },
      &quot;geometry&quot;: {
        &quot;coordinates&quot;: [
          34.738718987625106,
          -0.10390483386935045
        ],
        &quot;type&quot;: &quot;Point&quot;
      }
    },
    ---snip----</code></pre>
<p>Below is an example of a <a href="https://www.oracle.com/ke/database/what-is-json/">json file structure</a>.</p>
<pre><code>{

&quot;Influencers&quot; :   [ 
{
 &quot;name&quot; : &quot;Jaxon&quot;, 
 &quot;age&quot; : 42, 
 &quot;Works At&quot; : &quot;Tech News&quot;
}

{
 &quot;name&quot; : &quot;Miller&quot;, 
 &quot;age&quot; : 35
 &quot;Works At&quot; : &quot;IT Day&quot;
}

] 
}</code></pre>
</div>
<div id="why-geojson" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Why <code>geojson</code>?<a href="using-geojson-in-leaflet.html#why-geojson" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Yours truly could be wrong, but one advantage of <code>geojson</code> and <code>json</code> is that it’s minimal on size (sometimes) and is more portable than shapefiles. Shapefiles are dependent on other data formats that accompany it, such as <code>.shx</code>, <code>.dbf</code>, <code>.prj</code> and others that provide geospatial orientation, metadata, attributes and others. GeoJSON and JSON formats will come as standalone and holding the same amount of data.</p>
<p>So when do I use shapefiles vis a vis GeoJson? If you want to work with geospatial data in a web interface, <code>geojson</code> is the way to go. Period.</p>
</div>
<div id="creating-a-geojson-file" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Creating a geojson file<a href="using-geojson-in-leaflet.html#creating-a-geojson-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“Creating a geojson file with several dictionaries in it looks very intimidating. No hope of creating one without errors.” You may think to yourself. Precisely, but luckily, we have the <a href="https://geojson.io/#map=2/0/20">geojson.io</a> website that does the heavylifting for us. We shall head over to it and create a <code>geojson</code> file of some cities and their population.</p>
<p>First, of all, the website looks like this, a cool global map powered by Mapbox.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="using-geojson-in-leaflet.html#cb39-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/mapbox-front.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/mapbox-front.jpg" width="958" /></p>
<p>On your right, under the <strong>&lt;/&gt;JSON</strong> tab, the Mapbox folks have already given you a headstart by indicating what feature type and features will go into your <code>geojson</code> file. These are important as any website uses these keywords when parsing information from the GeoJSON file. Zoom to Kenya and click a point on top of the Nairobi dot pin, like shown below. Use the highlighted pin in the image below to create a marker over Nairobi.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="using-geojson-in-leaflet.html#cb40-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/nairobi-pin.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/nairobi-pin.jpg" width="960" /></p>
<p>By doing so, you will realize that a new dictionary of <code>type</code>, <code>properties</code> and <code>geometry</code> appears within the <strong>features</strong> list. These new keys provide the additional spatial and geometry data in their values in which a website when parsing this information can place them at their appropriate earth locations.</p>
<p>Now move over to the <strong>Table</strong> tab and click new column as shown below.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="using-geojson-in-leaflet.html#cb41-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/table.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/table.jpg" width="956" /></p>
<p>Click on it and in the graphic that appears, give your column the name <strong>City</strong>. Click <strong>Ok</strong> and in the table cell that appears, type <strong>Nairobi</strong>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="using-geojson-in-leaflet.html#cb42-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/nairobi-named.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/nairobi-named.jpg" width="960" /></p>
<p>Now create a new pin over <em>Kisumu</em> and a new dictionary will appear below that of Nairobi and a new table row will appear in the <strong>Table</strong> tab. Do the rest for the following cities: Mombasa, Nakuru, Nyeri, Machakos and Malindi. Legally speaking, only the first four are cities by law, the rest are just towns but for the sake of this tutorial, let’s corporately refer to them as cities.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="using-geojson-in-leaflet.html#cb43-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/cities-named.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/cities-named.jpg" width="958" /></p>
<p>Alright, one process down, one more to go. We will fill these cities with their population statistics. Create a new column with the heading “Population”. Fill each of the cities with the following statistics.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="using-geojson-in-leaflet.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read.csv</span>(<span class="st">&quot;D:/gachuhi/my-leaflet-vs/data/points.csv&quot;</span>)[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>##       City  Population
## 1  Nairobi 4, 300, 000
## 2   Kisumu    610, 082
## 3  Mombasa 1, 440, 000
## 4   Nakuru    422, 000
## 5    Nyeri    759, 164
## 6 Machakos 1, 422, 000
## 7  Malindi    119, 859</code></pre>
<p>Once done, head over to the top left of the <a href="http://geojson.io/">geojson.io</a> website, and click <strong>Save</strong>. A list of options will appear, click on save as <strong>geojson</strong>. It should appear somewhere in your <em>Downloads</em> directory.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="using-geojson-in-leaflet.html#cb46-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/geojson-save.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/geojson-save.jpg" width="960" /></p>
</div>
<div id="saving-the-geojson-to-github" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Saving the Geojson to Github<a href="using-geojson-in-leaflet.html#saving-the-geojson-to-github" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, based on experience, using a local Geojson file (one within your computer directory) is painful in JavaScript. The error I faced had to do with servers or something. To get a way around this and still be able to display <code>.geojson</code> data in Leaflet, the data had to be stored on an online server, in this case Github. We would love to show you how to save data on Github, but this would make this chapter long. Therefore, and with sincere apologies, it would be best if you googled it out.</p>
<p>However, on the bright side, we have provided the GeoJSON we will use accessible from this <a href="https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson">link</a>.</p>
</div>
<div id="loading-the-geojson-into-leaflet" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Loading the GeoJSON into Leaflet<a href="using-geojson-in-leaflet.html#loading-the-geojson-into-leaflet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As they always say, there are many ways of killing a rat. There are around three ways in which to load GeoJson data into leaflet, at least from our discovery. We shall start with the easiest and most unreliable to what we consider the best. Let start with the easy one, loading a <code>.geojson</code> file from within our Javascript file itself.</p>
<div id="the-easy-way" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> The easy way<a href="using-geojson-in-leaflet.html#the-easy-way" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First of all create a blank JavaScript file called <code>geojson.js</code>. Thereafter, go to your <code>map.html</code> file which you had created last in <a href="first-leaflet-map.html#setting-the-superstructure">Chapter 2</a> Open it. Change the value in the <code>src</code> attribute within the <code>&lt;script&gt;</code> tag of the <code>&lt;body&gt;</code>–the one inside the <code>&lt;div&gt;</code> element with <code>id="myMap"</code> to read <code>"geojson.io"</code> like below.</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
    &lt;head&gt;
        -- snip ---
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id=&quot;myMap&quot;&gt;
            &lt;script src=&quot;geojson.js&quot;&gt;
            &lt;/script&gt; 
        &lt;/div&gt;  
        
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Alright. Head over to your <code>geojson.js</code> and as always, add the leaflet classes <code>L.map</code> and <code>L.tileLayer</code>. We set the view of our new Leaflet map to that of Nairobi. Your blank <code>geojson.js</code> should now be filled with the below code.</p>
<pre><code>var map = L.map(&#39;myMap&#39;).setView([-1.295287148, 36.81984753], 7);

L.tileLayer(&#39;https://tile.openstreetmap.org/{z}/{x}/{y}.png&#39;, {
    maxZoom: 19,
    attribution: &#39;&amp;copy; &lt;a href=&quot;http://www.openstreetmap.org/copyright&quot;&gt;OpenStreetMap&lt;/a&gt;&#39;
}).addTo(map);</code></pre>
<p>Okay. Head over to <a href="geojson.io">geojson.io</a> website and right under the <strong>&lt;/&gt;JSON</strong> you will see a copy icon.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="using-geojson-in-leaflet.html#cb49-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/geojson-copy.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/geojson-copy.jpg" width="370" />
Click it and past it in your <code>geojson.js</code> file right above the other <code>L.map</code> and <code>L.tileLayer</code> classes. Your <code>geojson.js</code> should look like below.</p>
<pre><code>var cities = {
    &quot;type&quot;: &quot;FeatureCollection&quot;,
    &quot;features&quot;: [
      {
        &quot;type&quot;: &quot;Feature&quot;,
        &quot;properties&quot;: {
          &quot;City&quot;: &quot;Nairobi&quot;,
          &quot;Population&quot;: &quot;4, 300, 000&quot;
        },
        &quot;geometry&quot;: {
          &quot;coordinates&quot;: [
            36.8198475311531,
            -1.2952871483350066
          ],
          &quot;type&quot;: &quot;Point&quot;
        }
      },
      -- snip ---
      {
        &quot;type&quot;: &quot;Feature&quot;,
        &quot;properties&quot;: {
          &quot;City&quot;: &quot;Malindi&quot;,
          &quot;Population&quot;: &quot;119, 859&quot;
        },
        &quot;geometry&quot;: {
          &quot;coordinates&quot;: [
            40.10521499751357,
            -3.2138767356491655
          ],
          &quot;type&quot;: &quot;Point&quot;
        }
      }
    ]
  }


var map = L.map(&#39;myMap&#39;).setView([-1.295287148, 36.81984753], 7);

L.tileLayer(&#39;https://tile.openstreetmap.org/{z}/{x}/{y}.png&#39;, {
    maxZoom: 19,
    attribution: &#39;&amp;copy; &lt;a href=&quot;http://www.openstreetmap.org/copyright&quot;&gt;OpenStreetMap&lt;/a&gt;&#39;
}).addTo(map);
</code></pre>
<p>Refresh your <code>map.html</code>. It’s a map of Kenya alright, but none of our <code>.geojson</code> features appear yet. We are about to change that. Leaflet offers the <code>L.geoJSON</code> class to add GeoJSON data to a map. The class speaks for itself therefore, let’s use it to add our GeoJSON features. Add the following code below the other leaflet map class layers.</p>
<pre><code>L.geoJSON(cities).addTo(map);</code></pre>
<p>Refresh your <code>map.html</code>. The GeoJSON features should now appear at their exact locations.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="using-geojson-in-leaflet.html#cb52-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/geojson-leaflet.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/geojson-leaflet.jpg" width="952" /></p>
<p>How about if we made the markers more interactive, say they display popups as we did in <a href="add-ons.html#a-marker-with-a-popup">Chapter 3</a>? We want the city names to appear when the user clicks on the markers. Easy. Just create a function that does so as in the logic provided <a href="https://leafletjs.com/reference.html#geojson">here</a>. We customized it to our case to make sure it references to the <code>City</code> key which is part of the dictionary attached to the <code>properties</code> key.</p>
<pre><code>L.geoJSON(cities).bindPopup(function (layer) {
    return layer.feature.properties.City;
}).addTo(map);
</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="using-geojson-in-leaflet.html#cb54-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/geojson-names.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/geojson-names.jpg" width="504" /></p>
<p>There is one issue with this method. If we have a very long GeoJSON data structure, it will clatter our JavaScript file. We only worked with seven cities, but it is very common to work with data holding hundreds and even thousands of dictionaries. That would make your JavaScript file stretch to <em>ad infitum</em>.</p>
<p>This brings us to the other two methods, that of using the <strong>Ajax</strong> plugin and using the <strong>Fetch</strong> Application Programming Interface (API). Don’t let the words scare you. Take a break, grab a glass of water and come back.</p>
</div>
<div id="using-the-ajax-plugin" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Using the Ajax Plugin<a href="using-geojson-in-leaflet.html#using-the-ajax-plugin" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As the term ‘plugin’ suggests, this is an extension that offers additional functions to the core Leaflet plugin. The Ajax plugin is available from this <a href="https://github.com/calvinmetcalf/leaflet-ajax/archive/refs/heads/gh-pages.zip">link</a>. Download it to your directory preferably within the same directory as your <code>map.html</code> and <code>geojson.js</code>. Alright. Right under the <code>src</code> for <code>leaflet.js</code> in your <code>map.html</code>. Add the following <code>&lt;script&gt;</code> tag.</p>
<pre><code>    &lt;head&gt;
        -- snip --
        &lt;script src=&quot;leaflet-ajax-gh-pages\dist\leaflet.ajax.js&quot;&gt;&lt;/script&gt;
        
    &lt;/head&gt;
    -- snip --</code></pre>
<p>This file will allow you to add <code>.geojson</code> files to your Leaflet map. However, there is a catch, both the Ajax and Fetch APIs only work with GeoJson file formats saved on a web server. Based on experience, they will not work with local GeoJson files. As a work around, we saved our GeoJSON file to Github. Don’t worry, here is the <a href="https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson">link</a> to the raw <code>.geojson</code> file we had created earlier.</p>
<p>We shall call our GeoJSON file from Github using Ajax as shown in the code below. Please remember to comment out your <code>var cities</code> and <code>L.geoJSON</code> using <code>\\</code> because they are irrelevant in this particular case. You actually should.</p>
<pre><code>var geojsonLayer = new L.geoJson.ajax(&quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson&quot;).addTo(map);</code></pre>
<p>Your map should now show the markers of our cities. If you are hawk eyed, you may have noticed that the syntax is a bit different, both from the Ajax Website and that of the <code>L.geoJSON</code> from Leaflet. Starting with the latter, we have instead used <code>L.geoJson</code> and unlike in the creators website where he used <code>var geojsonLayer = new L.GeoJSON.AJAX(&lt;your-geojson-file&gt;)</code> we used the following syntax: <code>L.geoJson.ajax()</code> (ajax and geoJson begin with small case). Actually, that’s what worked after a lengthy web search.</p>
<p>Just like using <code>L.geoJSON</code>, we can also add popups after calling the <code>.ajax</code> method.</p>
<pre><code>var geojsonLayer = new L.geoJson.ajax(&quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson&quot;)
    .bindPopup(function (layer) {
        return layer.feature.properties.City;
    }).addTo(map);</code></pre>
<p>Doing so should make the city names appear on click on your leaflet map.</p>
</div>
<div id="using-fetch-api" class="section level3 hasAnchor" number="5.6.3">
<h3><span class="header-section-number">5.6.3</span> Using Fetch API<a href="using-geojson-in-leaflet.html#using-fetch-api" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Fetch API is a modern interface that allows you to make HTTP requests to servers from web browsers. In other words, it searches for a resource over the web and retrieves it, thus giving it back to you. Think of it as a dog in which you throw a saucer and tell your faithful hound “Sabre, fetch!”. The dog runs after the saucer, grips it with its canines before it touches ground and quickly brings it back to you. Same case with Fetch API!</p>
<p>We had mentioned we will show how to retreive our Github stored GeoJSON data and we shall stick to the script. We shall also attempt to explain how this <code>fetch</code> works.</p>
<p>First things first. We shall call the <code>fetch</code> function and pass it our Github url containing our GeoJSON text. Since <code>fetch</code> is an API, it retrieves data from Github.io –the server in this case–and brings it to our laptop the – the client. Enough IT. Let’s write it down.</p>
<pre><code>fetch(&quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson&quot;)</code></pre>
<p>Okay. Next step, once the server beams back the data to us, what do we do with it? According to <a href="https://www.digitalocean.com/community/tutorials/js-fetch-api">Digital Ocean</a>, the response is not <em>actually</em> the data in the original format but rather <em>a series of methods that can be used depending on what you want to do with the information</em>. We have to convert the object to a specific format. In this case, a JSON format. And to do this data conversion, the <code>json()</code> method is used. Actually, a function is created to do this. In the code below the function appears in parenthesis after <code>.then</code>.</p>
<pre><code>fetch(&quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson&quot;)
    .then(function(response) {
        return response.json()
    })</code></pre>
<p>The above function takes the <code>response</code> argument and convert it to JSON by appending the <code>.json()</code> method to it.</p>
<p>After converting our response to JSON, it still needs to be processed further. Processed to what? To a GeoJSON file and subsequently add it to our Leaflet Map.</p>
<pre><code>fetch(&quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson&quot;)
    .then(function(response) {
        return response.json()
    })
    .then(function(data) {
        L.geoJson(data).addTo(map);
    })
</code></pre>
<p>We shall also add one more function –the <code>catch()</code> method. <code>catch()</code> is a method that returns an action if our response to the server has been rejected. We shall show the code and demonstrate it.</p>
<pre><code>fetch(&quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson&quot;)
    .then(function(response) {
        return response.json()
    })
    .then(function(data) {
        L.geoJson(data).addTo(map);
    })
    .catch(function(error) {
        console.log(`This is the error: ${error}`)
    })
</code></pre>
<p>To see the <code>catch()</code> in action, omit the last letter in our url so that it reads <code>cities-geojson.geojso</code>. You read it right. Just omit the letter ‘n’ for now for goodness sake. Reload your <code>map.html</code>. Right click the webmap page and click on <strong>Inspect</strong> in the small interface that appears. Head over to the console tab and see the error response. It should read like below.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="using-geojson-in-leaflet.html#cb62-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/catch-error.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/catch-error.jpg" width="956" /></p>
<p>Restore the omitted letter and reload your <code>map.html</code>. Your leaflet map should have the city markers overlain just like in the case of using Ajax plugin or hardcoding the Geojson data into <code>var cities</code>. To stretch your Javascript skills further, we can shorten our code further by retaining the arguments <code>response</code>, <code>data</code> and <code>error</code> and using the arrow function <code>=&gt;</code> to pass on the return statements, like so.</p>
<pre><code>fetch(&quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson&quot;)
    .then((response) =&gt;{
        return response.json()
    })
    .then((data) =&gt; {
        L.geoJson(data).addTo(map);
    })
    .catch((error) =&gt; {
        console.log(`This is the error: ${error}`)
    })</code></pre>
<p>It looks cryptic but don’t cry! We have only ommitted the <code>function()</code> keyword and instead added <code>=&gt;</code> between <code>function()</code> and the curly brackets <code>{&lt;code-to-run&gt;}</code> which is the function body, aka where the magic happens. Just like when using Ajax, we can also add other functionalities within <code>L.geoJSON</code>. In here, and thanks to the use of template literals <code>(``)</code>, we can even add statements and refer to our GeoJson keys (and in some cases, even variables) using <code>${}</code>. Whatever is within the <code>${}</code> is executed and passed out as a string to the template literals.</p>
<pre><code>fetch(&quot;https://raw.githubusercontent.com/sammigachuhi/geojson_files/main/cities-geojson.geojson&quot;)
    .then((response) =&gt;{
        return response.json()
    })
    .then((data) =&gt; {
        L.geoJson(data).bindPopup((layer) =&gt; {
            return `City: ${layer.feature.properties.City},&lt;br&gt;
            Population: ${layer.feature.properties.Population}`}).addTo(map);
    })
    .catch((error) =&gt; {
        console.log(`This is the error: ${error}`)
    })
</code></pre>
<p>In our case, we added the HTML tag <code>&lt;br&gt;</code> to separate the <code>City</code> and <code>Population</code> keys from our GeoJSON. What we have are neat markers showing both the city name and population figures in two separate lines.</p>
<p>Phew! Enough Javascript for a day!</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="using-geojson-in-leaflet.html#cb65-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">rep</span>(<span class="st">&quot;D:/gachuhi/my-leaflet/images/city-population.jpg&quot;</span>))</span></code></pre></div>
<p><img src="../images/city-population.jpg" width="928" /></p>
<p>Here are the <a href="https://www.dropbox.com/scl/fo/uj45qo0gmed5xudmw1xja/h?dl=0&amp;rlkey=09mhhfdualbs92f7wg5atgdrx">full files</a>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="embedding-leaflet-map-to-an-external-website.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="create-your-own-custom-markers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-Using_geojson_files_in_Leaflet.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
